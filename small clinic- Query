
CREATE OR REPLACE VIEW PATIENT_MEDICATION_V AS
SELECT P.PID , P.NAME AS PATIENT  , S.NAME AS STAFF , D. DIAGNOSTIC , M.TYPE AS MEDICINE , 
COUNT(TYPE) OVER (PARTITION BY P.PID ) AS COUNT_PATIENT_MED , 
(CASE TYPE
WHEN 'ANTIHISTAMINES' THEN 'Do not take 2 antihistamines together'
WHEN 'INHALED CORTICOSTEROIDS' THEN 'Avoid all immunizations while on steroids'
WHEN'ALENDRONATE (FOSAMAX)' THEN 'This medicine could lower the amount of calcium in your blood'
WHEN 'RISEDRONATE (ACTONEL)' THEN 'Risedronate may cause ulcers (sores) in the esophagus'
ELSE 'NO COMMENT' END) AS CAUTION_MEDICINE
FROM PATIENT P JOIN MEDICINE M ON P.PID = M.PID JOIN DIAGNOSIS D ON P.PID=D.PID JOIN STAFF S ON S.SID = P.SID
ORDER BY COUNT_PATIENT_MED DESC ;



CREATE OR REPLACE VIEW COMMON_DIAGNOSIS_V AS 
SELECT DIAGNOSTIC , COUNT(DIAGNOSTIC) AS COMM_DIGANOSIS FROM DIAGNOSIS GROUP BY DIAGNOSTIC ORDER BY COMM_DIGANOSIS DESC ;

SELECT S.SID , COUNT (P.PID) AS COUNT_STAFF
FROM STAFF S JOIN PATIENT P ON S.SID=P.SID
GROUP BY S.SID ORDER BY COUNT_STAFF DESC ;

CREATE OR REPLACE VIEW PATIENT_STATUS AS 
SELECT P.PID , P.NAME AS PATIENT , APPOINMENT_DATE , S.NAME AS STAFF , D. DIAGNOSTIC , M.TYPE AS MEDICINE 
FROM PATIENT P JOIN MEDICINE M ON P.PID = M.PID JOIN DIAGNOSIS D ON P.PID=D.PID JOIN STAFF S ON S.SID = P.SID ;


